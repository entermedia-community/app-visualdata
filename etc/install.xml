<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="default" name="app-visualdata">

	<target name="default" depends="clean, upgrade" />

	<property name="appname" value="${ant.project.name}" />
	<property name="org" value="eInnovation, inc." />
	<property name="build" location="./tmp/oe_upgrade" />
	<property name="unpack_dest" location="${build}/unpacked" />
	<property name="wardir" location="${build}/wartmp" />
	<property name="webinf" location="WEB-INF" />
	<property name="final_dest" value="../visualdata" />
	<property name="payload" value="${appname}.zip" />
	<property name="lastbuild" value="http://dev.entermediasoftware.com/jenkins/view/Visual%20Data/job/app-visualdata%20visual_data/lastSuccessfulBuild/artifact/deploy/${payload}"/>

	<target name="clean">
		<delete dir="${build}" />
		<delete dir="${final_dest}" />
	</target>

	<target name="init">
		<mkdir dir="${unpack_dest}" />
		<mkdir dir="${final_dest}" />
	</target>

	<target name="update-dependencies" depends="init">
		<mkdir dir="${build}" />
		<get src="${lastbuild}" dest="${build}/${payload}" />
	</target>

	<target name="unzip" depends="update-dependencies">
		<unzip dest="${unpack_dest}">
			<fileset dir="${build}">
				<include name="${payload}" />
			</fileset>
		</unzip>
	</target>

	<target name="upgrade" depends="unzip">
		<copy todir="${final_dest}" preservelastmodified="true">
			<fileset dir="${build}/visualdata" />
		</copy>
		<delete dir="${build}" />
	</target>

</project>
